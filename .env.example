# =============================================================================
# DOCUMENT MANAGER - ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DB_NAME=docmanager
DB_USER=postgres
DB_PASSWORD=your_secure_postgres_password_here_min_16_chars
DB_HOST=postgres
DB_PORT=5432
DB_SSL_MODE=disable

# Connection pool settings
DB_MAX_OPEN_CONNS=100
DB_MAX_IDLE_CONNS=10
DB_CONN_MAX_LIFETIME=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your_secure_redis_password_here_min_16_chars
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_POOL_SIZE=10

# Session configuration
REDIS_SESSION_TTL=86400  # 24 hours in seconds

# =============================================================================
# MINIO (OBJECT STORAGE) CONFIGURATION
# =============================================================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=your_secure_minio_password_here_min_16_chars
MINIO_ENDPOINT=minio:9000
MINIO_USE_SSL=false
MINIO_REGION=us-east-1

# Bucket names
MINIO_BUCKET_DOCUMENTS=documents
MINIO_BUCKET_THUMBNAILS=thumbnails
MINIO_BUCKET_TEMP=temp

# Upload limits
MAX_UPLOAD_SIZE=5368709120  # 5GB in bytes
MAX_FILE_SIZE=1073741824    # 1GB in bytes

# =============================================================================
# MEILISEARCH CONFIGURATION
# =============================================================================
MEILI_MASTER_KEY=your_32_character_master_key_here_exactly_32_chars
MEILI_HOST=meilisearch
MEILI_PORT=7700
MEILI_ENV=development  # production, development

# Index settings
MEILI_INDEX_PREFIX=docmanager_

# =============================================================================
# NATS JETSTREAM CONFIGURATION
# =============================================================================
NATS_URL=nats://nats:4222
NATS_CLUSTER_ID=docmanager-cluster
NATS_CLIENT_ID=docmanager-client

# Stream names
NATS_STREAM_DOCUMENTS=documents
NATS_STREAM_OCR=ocr-processing
NATS_STREAM_NOTIFICATIONS=notifications
NATS_STREAM_AUDIT=audit-logs

# =============================================================================
# CLICKHOUSE CONFIGURATION
# =============================================================================
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_DB=docmanager
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=your_clickhouse_password_here

# =============================================================================
# PADDLEOCR CONFIGURATION
# =============================================================================
PADDLEOCR_HOST=paddleocr
PADDLEOCR_PORT=8080
PADDLEOCR_TIMEOUT=60
PADDLEOCR_MAX_CONCURRENT=5

# OCR quality settings
OCR_DPI=300
OCR_LANGUAGE=en  # en, fr, es, de, etc.

# =============================================================================
# SHARED AUTHENTICATION CONFIGURATION
# =============================================================================
# IMPORTANT: Obtain these values from your infrastructure team
# These point to the SHARED Kratos and Hydra instances

# Shared Ory Kratos URLs (Identity Management)
SHARED_KRATOS_PUBLIC_URL=http://shared-kratos:14433
SHARED_KRATOS_ADMIN_URL=http://shared-kratos:14434

# Shared Ory Hydra URLs (OAuth2/OIDC Provider)
SHARED_HYDRA_PUBLIC_URL=http://shared-hydra:14444
SHARED_HYDRA_ADMIN_URL=http://shared-hydra:14445

# OAuth2 Client Credentials
# Register this application with your infrastructure team first!
OAUTH2_CLIENT_ID=document-manager-client
OAUTH2_CLIENT_SECRET=your_client_secret_from_infrastructure_team
OAUTH2_REDIRECT_URI=http://localhost:13000/auth/callback
OAUTH2_SCOPES=openid email profile offline_access

# JWT Configuration
JWT_ISSUER=http://shared-hydra:14444
JWT_AUDIENCE=document-manager-client
HYDRA_JWKS_URL=http://shared-hydra:14444/.well-known/jwks.json

# =============================================================================
# OATHKEEPER CONFIGURATION
# =============================================================================
OATHKEEPER_LOG_LEVEL=info  # debug, info, warn, error
OATHKEEPER_PROXY_PORT=4455
OATHKEEPER_API_PORT=4456

# Internal API secret for service-to-service communication
INTERNAL_API_SECRET=your_secure_internal_api_secret_min_32_chars

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Environment
ENVIRONMENT=development  # development, staging, production
APP_NAME=Document Manager
APP_VERSION=1.0.0

# Logging
LOG_LEVEL=debug  # debug, info, warn, error
LOG_FORMAT=json  # json, text

# Server configuration
SERVER_HOST=0.0.0.0
SERVER_READ_TIMEOUT=30
SERVER_WRITE_TIMEOUT=30
SERVER_IDLE_TIMEOUT=120

# CORS settings
CORS_ALLOWED_ORIGINS=http://localhost:13000,http://localhost:13001
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Requested-With,Accept
CORS_ALLOW_CREDENTIALS=true

# =============================================================================
# SERVICE PORTS
# =============================================================================
# API Gateway
OATHKEEPER_PROXY_PORT_EXTERNAL=14455
OATHKEEPER_API_PORT_EXTERNAL=14456

# Backend Services (internal)
TENANT_SERVICE_PORT=10001
DOCUMENT_SERVICE_PORT=10002
STORAGE_SERVICE_PORT=10003
SHARE_SERVICE_PORT=10004
RBAC_SERVICE_PORT=10005
QUOTA_SERVICE_PORT=10006
OCR_SERVICE_PORT=10007
CATEGORIZATION_SERVICE_PORT=10008
SEARCH_SERVICE_PORT=10009
NOTIFICATION_SERVICE_PORT=10010
AUDIT_SERVICE_PORT=10011

# Frontend Applications
USER_APP_PORT=13000
ADMIN_APP_PORT=13001

# =============================================================================
# PLAN & QUOTA CONFIGURATION
# =============================================================================
# Free Plan
PLAN_FREE_STORAGE_GB=5
PLAN_FREE_OCR_PAGES=50
PLAN_FREE_MAX_USERS=1
PLAN_FREE_MAX_FILE_SIZE_MB=100

# Pro Plan
PLAN_PRO_STORAGE_GB=100
PLAN_PRO_OCR_PAGES=500
PLAN_PRO_MAX_USERS=10
PLAN_PRO_MAX_FILE_SIZE_MB=500
PLAN_PRO_PRICE_USD=9.99

# Enterprise Plan
PLAN_ENTERPRISE_STORAGE_GB=1024
PLAN_ENTERPRISE_OCR_PAGES=5000
PLAN_ENTERPRISE_MAX_USERS=-1  # unlimited
PLAN_ENTERPRISE_MAX_FILE_SIZE_MB=5120
PLAN_ENTERPRISE_PRICE_USD=49.99

# Quota reset schedule (cron format)
QUOTA_RESET_CRON=0 0 1 * *  # First day of every month at midnight

# =============================================================================
# EMAIL CONFIGURATION (SMTP)
# =============================================================================
# Development: Use MailSlurper
SMTP_HOST=mailslurper
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@documentmanager.local
SMTP_FROM_NAME=Document Manager

# Production: Use real SMTP server
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASSWORD=your_sendgrid_api_key
# SMTP_FROM_EMAIL=noreply@yourdomain.com
# SMTP_FROM_NAME=Document Manager
SMTP_USE_TLS=true

# Email templates
EMAIL_TEMPLATE_PATH=./templates/emails

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Notification channels
NOTIFICATIONS_EMAIL_ENABLED=true
NOTIFICATIONS_IN_APP_ENABLED=true
NOTIFICATIONS_WEBHOOK_ENABLED=false

# Notification preferences (defaults for new users)
NOTIFICATIONS_DEFAULT_DOCUMENT_SHARED=true
NOTIFICATIONS_DEFAULT_DOCUMENT_COMMENTED=true
NOTIFICATIONS_DEFAULT_QUOTA_WARNING=true
NOTIFICATIONS_DEFAULT_QUOTA_EXCEEDED=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Rate limiting (requests per minute)
RATE_LIMIT_GLOBAL=1000
RATE_LIMIT_PER_USER=100
RATE_LIMIT_PER_TENANT=500
RATE_LIMIT_UPLOAD=10
RATE_LIMIT_DOWNLOAD=50

# Session settings
SESSION_TIMEOUT=86400  # 24 hours
SESSION_REFRESH_THRESHOLD=3600  # 1 hour

# Password requirements (for future local admin accounts)
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL=true

# File upload security
ALLOWED_FILE_TYPES=pdf,doc,docx,xls,xlsx,ppt,pptx,txt,jpg,jpeg,png,gif,bmp,svg,mp4,avi,mov,zip,rar,7z
BLOCKED_FILE_EXTENSIONS=exe,bat,cmd,sh,ps1,vbs,jar,dll,scr,com,pif,msi,reg,apk
VIRUS_SCAN_ENABLED=false  # Enable when antivirus is configured

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_ONLY=false

# =============================================================================
# MONITORING & OBSERVABILITY (Future)
# =============================================================================
# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Tracing
TRACING_ENABLED=false
TRACING_ENDPOINT=http://jaeger:14268/api/traces
TRACING_SAMPLE_RATE=0.1

# Health checks
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_OCR_ENABLED=true
FEATURE_AUTO_CATEGORIZATION_ENABLED=true
FEATURE_LINK_SHARING_ENABLED=true
FEATURE_EXTERNAL_SHARING_ENABLED=true
FEATURE_WEBHOOKS_ENABLED=false
FEATURE_API_KEYS_ENABLED=false
FEATURE_TWO_FACTOR_AUTH_ENABLED=false

# =============================================================================
# BACKUP & MAINTENANCE
# =============================================================================
# Backup schedule (cron format)
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 2 AM daily
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=backups

# Maintenance mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System is under maintenance. Please try again later.

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
# Only for development environment
DEBUG=false
ENABLE_SWAGGER=false
ENABLE_PROFILING=false
ENABLE_REQUEST_LOGGING=true
PRETTY_LOGS=true

# Mock services (for testing without dependencies)
MOCK_KRATOS=false
MOCK_HYDRA=false
MOCK_OCR=false
MOCK_EMAIL=false

# Seed data
SEED_DATABASE=false
SEED_ADMIN_EMAIL=admin@example.com
SEED_ADMIN_PASSWORD=Admin123!

# =============================================================================
# PRODUCTION SETTINGS
# =============================================================================
# SSL/TLS
SSL_ENABLED=false
SSL_CERT_PATH=/certs/cert.pem
SSL_KEY_PATH=/certs/key.pem

# Database SSL
DB_SSL_CERT=/certs/db-cert.pem
DB_SSL_KEY=/certs/db-key.pem
DB_SSL_ROOT_CERT=/certs/db-ca.pem

# Secrets encryption
ENCRYPTION_KEY=your_32_byte_encryption_key_for_sensitive_data_min_32_chars
ENCRYPTION_ALGORITHM=AES-256-GCM

# =============================================================================
# EXTERNAL INTEGRATIONS (Future)
# =============================================================================
# Webhook configuration
WEBHOOK_TIMEOUT=30
WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_DELAY=5

# Third-party services
SENTRY_DSN=
STRIPE_API_KEY=
SLACK_WEBHOOK_URL=

# =============================================================================
# NOTES
# =============================================================================
# 1. All passwords should be at least 16 characters long
# 2. Use strong, randomly generated passwords for production
# 3. Never commit the .env file to version control
# 4. Rotate secrets regularly (every 90 days recommended)
# 5. Use different credentials for each environment
# 6. Keep this file in sync with .env.example
# 7. For production, use a secrets management service (Vault, AWS Secrets Manager, etc.)
